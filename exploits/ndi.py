from time import sleep

from milkman.logger import logger

logger.add(
    sink=f"../logs/exploits/ndi.log",
    format="<d>{time:HH:mm:ss.SS}</d> | <level>{level:^8}</level> | {message}",
    enqueue=True,
    filter=lambda record: record["extra"]["file"] == "ndi.log",
    level="DEBUG",
    colorize=True,
)


def ndi(target_ip: str) -> str | list[str]:
    log = logger.bind(file="ndi.log")
    flags = ["test1", "test2"]
    log.debug(f"{__name__} against {target_ip}!")
    sleep(16)

    return flags
