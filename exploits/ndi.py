from time import sleep

from milkman.logger import logger

logger.add(
    sink=f"../logs/exploits/ndi.log",
    format="{time:HH:mm:ss.SS} [{level:^8}] : {message}",
    enqueue=True,
    filter=lambda record: record["extra"]["file"] == "ndi.log",
    level="DEBUG",
)


def ndi(target_ip: str) -> str | list[str]:
    log = logger.bind(file="ndi.log")
    flags = ["test1", "test2"]
    log.debug(f"{__name__} against {target_ip}!")
    sleep(16)

    return flags
