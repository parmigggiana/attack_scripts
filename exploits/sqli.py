from time import sleep

from milkman.logger import logger

logger.add(
    sink=f"../logs/exploits/sqli.log",
    format="{time:HH:mm:ss.SS} [{level:^8}] : {message}",
    enqueue=True,
    filter=lambda record: record["extra"]["file"] == "sqli.log",
    level="DEBUG",
)


def sqli(target_ip) -> str | list[str]:
    log = logger.bind(file="sqli.log")

    flag = "BURLACU"
    log.debug(f"{__name__} against {target_ip}!")
    sleep(12)
    return flag
