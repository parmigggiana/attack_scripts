from time import sleep

from milkman.logger import logger

logger.add(
    sink=f"../logs/exploits/sqli.log",
    format="<d>{time:HH:mm:ss.SS}</d> | <level>{level:^8}</level> | {message}",
    enqueue=True,
    filter=lambda record: record["extra"]["file"] == "sqli.log",
    level="DEBUG",
    colorize=True,
)


def sqli(target_ip) -> str | list[str]:
    log = logger.bind(file="sqli.log")

    flag = "THIS IS SO COOOOOL 3JR982398DM192MD03JF928NF923ND2=,JDD3298DJ2893EJDD892198JS389JDQ=TOTALLYWORKING"
    log.debug(f"{__name__} against {target_ip}!")
    sleep(12)
    return flag
